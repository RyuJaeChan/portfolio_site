![](https://i.imgur.com/wit0RGE.jpg)

위 사진은 열차의 선로를 변경하거나 스위치 ON/oFF를 제어하는 장치입니다. 자잋에 연겨로딘 전원, 제어 모듈 등을 PC에 연결하여 시리얼 통신을 통해 제어할 수 있습니다. 이 장치의 작동 및 정상 작동 여부를 검사하는 소프트웨어 개발 프로젝트에 참여하였습니다.

![](https://i.imgur.com/E1V1zVr.png)
프로그램 최초 실행 시 장치 제어를 위한 준비가 되었는지 확인합니다. 먼저 PC와 연결된 포트를 확인하여 장치 제어에 필요한 포트들이 올바르게 연결되었는지 검사합니다. 장비 제어를 위한 포트는 총 4개로 RS-232, RS3-422 규격의 포트를 사용합니다.
프로그램 실행 후 포트가 모두 연결되어 있으면 전원 장치와 제어 모듈에 명령어를 보내 장치의 상태를 점검합니다. 전원 장치에는 ON/OFF 명령과 전압 제어 명령을 내려 제어 모듈에 올바른 전압을 줄 수 있는 상태인지 확인합니다. 장비 제어를 위한 정원 장치는 2개가 필요하며 하나는 제어 모듈 장치에 전원을 공급하며 나머지 하나는 검사를 위한 Dummy 스위치에 전원을 공급합니다.
전원 장치 검사 후 제어 모듈을 검사합니다. 제어 모듈의 전원을 켜고 시리얼 포트를 통해 데이터가 수신되는지 확인합니다. RS-232포트를 통해 제어 명령을 보내는데 장비가 올바르게 동작하고 있다면 ACK 신호로 동일한 제어명령을 PC로 보내줍니다. RS-422포트는 장비의 현재 상태(모듈 타입, 제어 상태, 주소 등)의 정보를 지속적으로 전송해 줍니다. 장비의 정상작동 여부 검사는 장비가 PC로 보내는 데이터를 이용해 확인합니다.

![](https://i.imgur.com/RaulUHg.png)
장치의 연결 확인이 완료되면 제어 모듈의 검사를 시작할 수 있습니다. 사용자는 여러 검사중 한 가지를 선택해 반복 횟수, 시간을 설정합니다.

![](https://i.imgur.com/znrOuBC.png)
검사가 시작되면 화면을 통해 현재 진행 상황을 확인할 수 있습니다.

이 프로젝트를 진행하며 가장 어려웠던 부분은 멀티 쓰레드에 대한 처리였습니다. 본 프로그램은 동작을 위해 여러 쓰레드가 실행됩니다. C#에서 제공해주는 Monitor를 이용하여 데이터 공유의 처리는 어렵지 않았지만 프로그래밍 구동 중 포트별로 데이터가 수신되는 시점에 대해 고려하지 않아 애를 먹기도 했습니다. 실제 프로그램 개발에서 고려해야 하는 사항에 대해 공부할 수 있었습니다.